# コマンドラインが苦手な方のための使い方ガイド

このガイドは、コマンドラインの操作に慣れていない方でも `JisuiArc2PDF` を使えるように、準備から実行までの手順を詳しく解説します。

## 1. 準備編：ツールの用意と配置

最初に、変換に必要なツールをすべて一つのフォルダに集めます。

### 手順1：作業フォルダの作成
まず、作業用のフォルダをPCの好きな場所（例: デスクトップやドキュメントなど）に作成します。このガイドでは、例として `C:\JisuiTools` というフォルダ名で説明します。

### 手順2：ツールのダウンロードと配置
以下の4つのツールを、作成した作業フォルダ（`C:\JisuiTools`）の中に集めます。

#### ① JisuiArc2PDF スクリプト
- **ファイル**: `JisuiArc2PDF.ps1` と `JisuiArc2PDF.bat`
- **入手方法**: この2つのファイルを作業フォルダに置きます。

#### ② 7-Zip
- **役割**: 書庫ファイル（.rar, .zipなど）を展開するために使います。
- **入手方法**:
    1. [7-Zip公式サイト](https://www.7-zip.org/) にアクセスします。
    2. 「Windows 64ビット x64」の行にある「ダウンロード」リンクをクリックし、インストーラーをダウンロードします。
    3. ダウンロードしたインストーラーを実行して、7-Zipをインストールします。（設定はすべてデフォルトのままでOKです）
    4. インストール先フォルダ（通常は `C:\Program Files\7-Zip`）を開き、`7z.exe` と `7z.dll` の2つのファイルをコピーします。
    5. コピーした2つのファイルを、作業フォルダ（`C:\JisuiTools`）に貼り付けます。

#### ③ ImageMagick
- **役割**: 画像のサイズ変更や圧縮などの画像処理を行います。
- **入手方法**:
    1. [ImageMagick公式サイト](https://imagemagick.org/script/download.php) にアクセスします。
    2. 「Windows Binary Release」のセクションから、`...-x64-dll.exe` という名前のインストーラー（例: `ImageMagick-7.X.X-X-Q16-HDRI-x64-dll.exe`）をダウンロードします。
    3. ダウンロードしたインストーラーを実行します。
    4. **重要**: インストール中に「**Add application directory to your system path (PATH)**」というチェックボックスが表示されたら、**必ずチェックを入れてください。**
    5. インストール先フォルダ（通常は `C:\Program Files\ImageMagick-7...`）を開き、`magick.exe` をコピーします。
    6. コピーしたファイルを、作業フォルダ（`C:\JisuiTools`）に貼り付けます。

#### ④ PDFCPU
- **役割**: 画像ファイルをまとめてPDFを作成します。
- **入手方法**:
    1. [PDFCPU公式サイト](https://pdfcpu.io/download) にアクセスします。
    2. 「Windows (64-bit)」のセクションにある `pdfcpu_..._Windows_x86_64.zip` というリンクをクリックして、zipファイルをダウンロードします。
    3. ダウンロードしたzipファイルを解凍（展開）します。
    4. 解凍したフォルダの中から `pdfcpu.exe` をコピーします。
    5. コピーしたファイルを、作業フォルダ（`C:\JisuiTools`）に貼り付けます。

### 手順3：最終確認
すべての手順が終わると、作業フォルダ（`C:\JisuiTools`）には以下の6つのファイルが揃っているはずです。
- `JisuiArc2PDF.ps1`
- `JisuiArc2PDF.bat`
- `7z.exe`
- `7z.dll`
- `magick.exe`
- `pdfcpu.exe`

これで準備は完了です。

---

## 2. 実践編：ドラッグ＆ドロップでPDFを作成

準備が整ったら、PDFの作成はとても簡単です。

1.  **ドラッグ＆ドロップ**:
    -   PDFにしたい書庫ファイル（`.rar` や `.zip`）を、`JisuiArc2PDF.bat` のアイコンの上にマウスでドラッグ＆ドロップします。
    -   黒い画面（コマンドプロンプト）が表示されます。

2.  **対話形式で設定**:
    -   画面に、画質(Quality)や解像度(Resolution)、圧縮の判断基準(threshold)などに関する質問が順番に表示されます。
    -   `[ ]` が付いている質問は、**何も入力せずにEnterキーを押す**と、`[ ]` の中のおすすめ設定（デフォルト値）が自動的に使われます。
    -   こだわりがなければ、**すべての質問に対して、ただEnterキーを押していくだけでOK**です。

3.  **実行確認**:
    -   すべての質問に答えると、最終的に実行されるコマンドが表示され、「Press Enter to run, or Ctrl+C to cancel...」というメッセージで一時停止します。
    -   これは最終確認の画面です。そのまま **Enterキーを押す**と、PDF変換が始まります。

4.  **完了**:
    -   処理が始まると、たくさんの文字が画面に流れます。
    -   「Done. Press any key to exit.」と表示されたら、すべての処理は完了です。
    -   元の書庫ファイルがあった場所と同じ場所に、新しいPDFファイルが作成されていることを確認してください。

---

## 3. トラブル解決編

もし、うまくいかない場合は以下を確認してください。

### エラー: 「'pwsh' は、内部コマンドまたは外部コマンド、操作可能なプログラムまたはバッチ ファイルとして認識されていません。」

このエラーメッセージが表示された場合、PowerShell 7が正しくインストールされていないか、システムが `pwsh.exe` を見つけられない状態になっています。

-   **原因**:
    -   PowerShell 7がPCにインストールされていない。
    -   インストールはしたが、PATH環境変数への登録がされていない。

-   **解決策**:
    1. [PowerShell 7の公式サイト](https://learn.microsoft.com/ja-jp/powershell/scripting/install/installing-powershell-on-windows)にアクセスします。
    2. 「Downloads (stable)」のセクションから、`PowerShell-7.X.X-win-x64.msi` をダウンロードして実行します。
    3. インストーラーの途中で「Add PowerShell to Path Environment Variable」という項目が表示されたら、**必ずチェックを入れて**インストールを完了してください。
    4. インストール完了後、PCを再起動すると問題が解決する場合があります。