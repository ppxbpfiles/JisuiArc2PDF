# コマンドラインが苦手な方のための使い方ガイド

このガイドは、コマンドラインの操作に慣れていない方でも `JisuiArc2PDF` を使えるように、準備から実行までの手順を詳しく解説します。

## 1. 準備編：ツールの用意と配置

最初に、変換に必要なツールをすべて一つのフォルダに集めます。

### 手順1：作業フォルダの作成
まず、作業用のフォルダをPCの好きな場所（例: デスクトップやドキュメントなど）に作成します。このガイドでは、例として `C:\JisuiTools` というフォルダ名で説明します。

### 手順2：ツールのダウンロードと配置
以下のツールを、作成した作業フォルダ（`C:\JisuiTools`）の中に集めます。

#### ① JisuiArc2PDF スクリプト
- **ファイル**: `JisuiArc2PDF.ps1` と `JisuiArc2PDF.bat`
- **入手方法**: この2つのファイルを作業フォルダに置きます。

#### ② 7-Zip
- **役割**: 書庫ファイル（.rar, .zipなど）を展開するために使います。
- **入手方法**:
    1. [7-Zip公式サイト](https://www.7-zip.org/) にアクセスします。
    2. 「Windows 64ビット x64」の行にある「ダウンロード」リンクをクリックし、インストーラーをダウンロードします。
    3. ダウンロードしたインストーラーを実行して、7-Zipをインストールします。（設定はすべてデフォルトのままでOKです）
    4. インストール先フォルダ（通常は `C:\Program Files\7-Zip`）を開き、`7z.exe` と `7z.dll` の2つのファイルをコピーします。
    5. コピーした2つのファイルを、作業フォルダ（`C:\JisuiTools`）に貼り付けます。

#### ③ ImageMagick
- **役割**: 画像のサイズ変更や圧縮などの画像処理を行います。
- **入手方法**:
    1. [ImageMagick公式サイト](https://imagemagick.org/script/download.php) にアクセスします。
    2. 「Windows Binary Release」のセクションから、ファイル名に `static` と含まれるzipファイル（例: `ImageMagick-7.X.X-X-Q16-HDRI-x64-static.zip`）を探してダウンロードします。
    3. ダウンロードしたzipファイルを解凍（展開）します。
    4. 解凍したフォルダの中から `magick.exe` をコピーします。
    5. コピーしたファイルを、作業フォルダ（`C:\JisuiTools`）に貼り付けます。
- **ポイント**: static版の `magick.exe` は、それ単体で動作し、他にDLLファイルなどを必要としないため、管理がとても簡単です。

#### ④ PDFCPU
- **役割**: 画像ファイルをまとめてPDFを作成し、PDFのビューア設定を調整します。
- **入手方法**:
    1. [PDFCPU公式サイト](https://pdfcpu.io/download) にアクセスします。
    2. 「Windows (64-bit)」のセクションにある `pdfcpu_..._Windows_x86_64.zip` というリンクをクリックして、zipファイルをダウンロードします。
    3. ダウンロードしたzipファイルを解凍（展開）します。
    4. 解凍したフォルダの中から `pdfcpu.exe` をコピーします。
    5. コピーしたファイルを、作業フォルダ（`C:\JisuiTools`）に貼り付けます。

#### ⑤ QPDF（オプション）
- **役割**: PDFのリニアライズ処理に使用されます（オプション）。
- **入手方法**:
    1. [QPDF公式サイト](https://github.com/qpdf/qpdf/releases) にアクセスします。
    2. 最新バージョンの `qpdf-...-mingw64.zip` というリンクをクリックして、zipファイルをダウンロードします。
    3. ダウンロードしたzipファイルを解凍（展開）します。
    4. 解凍したフォルダの中から `qpdf.exe` と関連するDLLファイル（例: `qpdf30.dll`）をコピーします。
    5. コピーしたファイルを、作業フォルダ（`C:\JisuiTools`）に貼り付けます。

### 手順3：最終確認
すべての手順が終わると、作業フォルダ（`C:\JisuiTools`）には以下のファイルが揃っているはずです。
- `JisuiArc2PDF.ps1`
- `JisuiArc2PDF.bat`
- `7z.exe`
- `7z.dll`
- `magick.exe`
- `pdfcpu.exe`

QPDFをインストールした場合は、`qpdf.exe` と関連するDLLファイルも配置してください。

これで準備は完了です。

---

## 2. 実践編：簡単な方法でPDFを作成

準備が整ったら、いよいよPDFを作成します。一番簡単な方法は、同梱されているバッチファイルを使うことです。

### 方法1：バッチファイルで起動（一番かんたん）

1.  **重要**: 変換したい書庫ファイル（`.rar` や `.zip`）を、ツールと同じ作業フォルダの中に移動しておきます。
2.  `JisuiArc2PDF.bat` をダブルクリックします。
3.  黒いウィンドウ（PowerShell）が自動的に起動し、すぐに対話モードが始まります。

### 方法2：手動でPowerShellを起動

もしバッチファイルがうまく動かない場合は、手動でPowerShellを起動することもできます。

1.  エクスプローラーで、作業フォルダを開きます。
2.  エクスプローラーのアドレスバー（フォルダのパスが表示されている場所）をクリックし、`pwsh` と入力して `Enter` キーを押します。
3.  起動したPowerShellの画面で、以下のコマンドを入力して `Enter` キーを押します。
    ```powershell
    pwsh -File .\JisuiArc2PDF.ps1
    ```

### 対話モードでの設定

上記いずれかの方法でスクリプトを起動すると、対話モードが始まります。

1.  最初に「処理する書庫のパスを入力してください」と聞かれます。変換したいファイル名（ワイルドカードも使えます）を入力して `Enter` を押します。
    -   **例1（フォルダ内すべて）**: フォルダ内の全てのrarファイルを処理したい場合 → `*.rar`
    -   **例2（個別指定）**: 特定のファイルだけを処理したい場合 → `"MyBook.zip"`
2.  パスを入力すると、画質や解像度などに関する質問が順番に表示されます。
    -   `[ ]` が付いている質問は、**何も入力せずにEnterキーを押す**と、`[ ]` の中のおすすめ設定（デフォルト値）が自動的に使われます。
    -   こだわりがなければ、**すべての質問に対して、ただEnterキーを押していくだけでOK**です。
    -   途中、傾き補正、余白除去、そして新機能の**見開きページの分割**など、画像を補正するかどうかを尋ねられます。見開きでスキャンした本を個別のページに分けたい場合は、「見開きページを分割しますか」の質問に `y` と答えてください。その後の「本の綴じ方向」の質問では、漫画ならデフォルトの「右綴じ」のままで大丈夫です。
3.  すべての質問に答えると、PDF変換が始まります。
4.  「すべての処理が完了しました。」と表示されたら、完了です。何かキーを押すとウィンドウが閉じます。
5.  作業フォルダに、新しいPDFファイルが作成されていることを確認してください。

---

## 3. トラブル解決編

もし、うまくいかない場合は以下を確認してください。

### エラー: 「'pwsh' は、内部コマンドまたは外部コマンド、操作可能なプログラムまたはバッチ ファイルとして認識されていません。」

このエラーメッセージが表示された場合、PowerShell 7が正しくインストールされていないか、システムが `pwsh.exe` を見つけられない状態になっています。

-   **原因**:
    -   PowerShell 7がPCにインストールされていない。
    -   インストールはしたが、PATH環境変数への登録がされていない。

-   **解決策**:
    1. [PowerShell 7の公式サイト](https://learn.microsoft.com/ja-jp/powershell/scripting/install/installing-powershell-on-windows)にアクセスします。
    2. 「Downloads (stable)」のセクションから、`PowerShell-7.X.X-win-x64.msi` をダウンロードして実行します。
    3. インストーラーの途中で「Add PowerShell to Path Environment Variable」という項目が表示されたら、**必ずチェックを入れて**インストールを完了してください。
    4. インストール完了後、PCを再起動すると問題が解決する場合があります。