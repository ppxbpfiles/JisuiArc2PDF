
# コマンドラインが苦手な方のための使い方ガイド (Python版)

このガイドは、コマンドラインの操作に慣れていない方でも `JisuiArc2PDF.py` を使えるように、準備から実行までの手順を詳しく解説します。

## 1. 準備編：ツールの用意と配置

最初に、変換に必要なツールをすべて一つのフォルダに集めます。

### 手順1：作業フォルダの作成
まず、作業用のフォルダをPCの好きな場所（例: デスクトップやドキュメントなど）に作成します。このガイドでは、例として `C:\JisuiTools_py` というフォルダ名で説明します。

### 手順2：ツールのダウンロードと配置

#### ① Python のインストール (最重要)
このスクリプトを動かすには、PCにPythonがインストールされている必要があります。
1. [Python公式サイトのダウンロードページ](https://www.python.org/downloads/windows/)にアクセスします。
2. 「Stable Releases」の中から、最新版の「Download Windows installer (64-bit)」をクリックしてインストーラーをダウンロードします。
3. ダウンロードしたインストーラーを実行します。
4. **重要**: インストーラーの最初の画面で、**必ず一番下の「Add python.exe to PATH」というチェックボックスにチェックを入れてください。** これを忘れると、スクリプトが動作しません。
5. 「Install Now」をクリックして、インストールを完了します。

#### ② JisuiArc2PDF スクリプト (Python版)
- **ファイル**: `JisuiArc2PDF.py` と `JisuiArc2PDF_py.bat`
- **入手方法**: この2つのファイルを作業フォルダに置きます。

#### ③ 7-Zip
- **役割**: 書庫ファイル（.rar, .zipなど）を展開するために使います。
- **入手方法**:
    1. [7-Zip公式サイト](https://www.7-zip.org/) にアクセスします。
    2. 「Windows 64ビット x64」のインストーラーをダウンロードし、インストールします。
    3. インストール先フォルダ（通常は `C:\Program Files\7-Zip`）を開き、`7z.exe` と `7z.dll` の2つのファイルをコピーします。
    4. コピーした2つのファイルを、作業フォルダに貼り付けます。

#### ④ ImageMagick
- **役割**: 画像のサイズ変更や圧縮などの画像処理を行います。
- **入手方法**:
    1. [ImageMagick公式サイト](https://imagemagick.org/script/download.php) にアクセスします。
    2. 「Windows Binary Release」のセクションから、ファイル名に `static` と含まれるzipファイル（例: `ImageMagick-7.X.X-X-Q16-HDRI-x64-static.zip`）を探してダウンロードします。
    3. ダウンロードしたzipファイルを解凍（展開）します。
    4. 解凍したフォルダの中から `magick.exe` をコピーし、作業フォルダに貼り付けます。
- **ポイント**: static版の `magick.exe` は、それ単体で動作するため管理が簡単です。

#### ⑤ PDFCPU
- **役割**: 画像ファイルをまとめてPDFを作成します。
- **入手方法**:
    1. [PDFCPU公式サイト](https://pdfcpu.io/download) にアクセスします。
    2. 「Windows (64-bit)」のzipファイルをダウンロードし、解凍します。
    3. 解凍したフォルダの中から `pdfcpu.exe` をコピーし、作業フォルダに貼り付けます。

#### ⑥ QPDF（オプション）
- **役割**: PDFのウェブ最適化（リニアライズ）処理に使用されます。
- **入手方法**:
    1. [QPDF公式サイト](https://github.com/qpdf/qpdf/releases) にアクセスします。
    2. 最新バージョンの `...mingw64.zip` をダウンロードし、解凍します。
    3. 解凍したフォルダの中から `qpdf.exe` と関連するDLLファイル（例: `qpdf-11.dll`）をコピーし、作業フォルダに貼り付けます。

### 手順3：最終確認
すべての手順が終わると、作業フォルダには以下のファイルが揃っているはずです。
- `JisuiArc2PDF.py`
- `JisuiArc2PDF_py.bat`
- `7z.exe`, `7z.dll`
- `magick.exe` (static版)
- `pdfcpu.exe`
- (任意) `qpdf.exe` とそのDLL

これで準備は完了です。

---

## 2. 実践編：ドラッグ＆ドロップでPDFを作成

準備が整ったら、PDFの作成はとても簡単です。

1.  **ドラッグ＆ドロップ**:
    -   PDFにしたい書庫ファイル（`.rar` や `.zip`）を、`JisuiArc2PDF_py.bat` のアイコンの上にマウスでドラッグ＆ドロップします。
    -   黒い画面（コマンドプロンプト）が表示されます。

2.  **対話形式で設定**:
    -   画面に、画質(Quality)や解像度(Resolution)などに関する質問が順番に表示されます。
    -   `[ ]` が付いている質問は、**何も入力せずにEnterキーを押す**と、`[ ]` の中のおすすめ設定（デフォルト値）が自動的に使われます。
    -   こだわりがなければ、**すべての質問に対して、ただEnterキーを押していくだけでOK**です。

3.  **実行確認**:
    -   すべての質問に答えると、最終的に実行されるコマンドが表示され、「Press Enter to run, or Ctrl+C to cancel...」というメッセージで一時停止します。
    -   そのまま **Enterキーを押す**と、PDF変換が始まります。

4.  **完了**:
    -   処理が始まると、たくさんの文字が画面に流れます。
    -   「Done. Press any key to exit.」と表示されたら、すべての処理は完了です。
    -   元の書庫ファイルがあった場所と同じ場所に、新しいPDFファイルが作成されていることを確認してください。

---

## 3. トラブル解決編

もし、うまくいかない場合は以下を確認してください。

### エラー: 「'python' は、内部コマンドまたは外部コマンド...として認識されていません。」

このエラーメッセージが表示された場合、Pythonが正しくインストールされていないか、システムが `python.exe` を見つけられない状態になっています。

-   **解決策**: 準備編の「① Python のインストール」に戻り、特にインストーラーの最初の画面で**「Add python.exe to PATH」にチェックを入れたか**を再確認し、必要であればPythonをインストールし直してください。
